<!DOCTYPE html>
<html lang="it">
    <head>
        <meta charset="UTF-8" />
        <title>Il Ciarnuro Round Timer</title>
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1" />
        <meta name="theme-color" id="theme-color" content="#000000"/>
        <link rel="shortcut icon" href="favicon.ico" />
        <link rel="icon" type="image/png" href="favicon.png" />
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="text/javascript" src="ciarnurort.js"></script>
        <link rel="manifest" href="manifest.json" />
    </head>
    <body>
        <div id="loadOverlay">
            <noscript>
                Attiva JavaScript, cappello di stagnola!
            </noscript>
        </div>
        <div class="slide invisible" id="welcome">
            <div class="full">
                <div class="content">
                    <img srcset="pics/lowspec/logo.webp 900w, pics/midspec/logo.webp 1800w, pics/ultraspec/logo.webp 2500w", alt="Logo" style="display:block;width:100%;height:auto;"/>
                    <div class="centered">
                        <input type="button" id="startBtn" onclick="newGame()" value="Nuova partita" /><input type="button" onclick="welcomeToPreviousGames()" value="Statistiche"/>
                    </div>
                    <div class="centered" style="margin:2em auto;font-size:0.75em"><a target="_blank" href="https://github.com/LupoPasiniGames/CiarnuroTimer-Web">Versione 1.2-it</a></div>
                </div>
            </div>
        </div>
        <div class="slide invisible" id="gameOptions">
            <div class="upper">
                <div class="content">
                    <div class="title">Nuova partita</div>
                    <form action="javascript:gameOptionsToPlayerManagement()">
                        <div class="entry"><div class="entryName">Durata turno (minuti)</div><div class="entryValue"><input type="button" class="small" value="-" onclick="decRoundDuration()"/><input type="text" id="roundDuration" style="width:5em" value="LOAD" onblur="checkRoundDuration()"/><input type="button" class="small" value="+" onclick="incRoundDuration()"/><input type="button" class="small" value="Reset" onclick="resetRoundDuration()"/></div></div>
                        <div class="entry"><div class="entryName">Limite turni</div><div class="entryValue"><input type="button" class="small" value="-" onclick="decMaxRounds()"/><input type="text" id="maxRounds" style="width:5em" value="LOAD" onblur="checkMaxRounds()"/><input type="button" class="small" value="+" onclick="incMaxRounds()"/><input type="button" class="small" value="Reset" onclick="resetMaxRounds()"/></div></div>
                        <div class="entry"><div class="entryName">Data di inizio</div><input type="date" id="startDate" class="entryValue" value="2062-01-01" min="0000-01-01" max="9999-01-01"/></div>
                        <input type="submit" tabIndex="4" style="display:none" />
                    </form>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Indietro" onclick="gameOptionsToWelcomeScreen()"/><input type="button" value="Avanti" onclick="gameOptionsToPlayerManagement()" />
            </div>
        </div>
        <div class="slide invisible" id="playerManagement">
            <div class="upper">
                <div class="content">
                    <div class="title">Squadre</div>
                    <div id="teams" class="list"></div>
                    <div class="title" style="margin-top:2em;">Giocatori</div>
                    <div id="players" class="list"></div>
                    <div style="height:5em">&nbsp;</div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Indietro" id="playerManagementToGameOptions" onclick="playerManagementToGameOptions()" /><input type="button" value="Conferma" onclick="playerManagementToGame()" />
            </div>
        </div>
        <div class="slide invisible" id="editTeam">
            <div class="upper">
                <div class="content">
                    <div class="title">Dettagli squadra</div>
                    <form action="javascript:checkAndSaveTeam()">
                        <div class="entry"><div class="entryName">Nome squadra</div><input type="text" class="entryValue" id="teamName" value=""/></div>
                        <input type="submit" style="display:none" />
                    </form>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Annulla" onclick="cancelTeamEdit()"/><input type="button" value="Conferma" onclick="checkAndSaveTeam()" />
            </div>
        </div>
        <div class="slide invisible" id="editPlayerRace">
            <div class="upper">
                <div class="content">
                    <div class="title">Razza giocatore</div>
                    <input type="button" class="raceButton" id="humanButton" onclick="raceSelect.value=RACES[0]"><input type="button" class="raceButton" id="kretoButton" onclick="raceSelect.value=RACES[1]">
                    <input type="button" class="raceButton" id="sauniElButton" onclick="raceSelect.value=RACES[2]"><input type="button" class="raceButton" id="sauniArcButton" onclick="raceSelect.value=RACES[3]">
                    <input type="button" class="raceButton" id="quarkButton" onclick="raceSelect.value=RACES[4]"><input type="button" class="raceButton" id="pravoWarButton" onclick="raceSelect.value=RACES[5]">
                    <input type="button" class="raceButton" id="pravoGuiButton" onclick="raceSelect.value=RACES[6]"><input type="button" class="raceButton" id="veriButton" onclick="raceSelect.value=RACES[7]">
                    <input type="button" class="raceButton" id="invoButton" onclick="raceSelect.value=RACES[8]"><input type="button" class="raceButton" id="draudButton" onclick="raceSelect.value=RACES[9]">
                    <input type="button" class="raceButton" id="skityButton" onclick="raceSelect.value=RACES[10]"><input type="button" class="raceButton" id="nakkiriButton" onclick="raceSelect.value=RACES[11]">
                    <input type="button" class="raceButton" id="makrianiButton" onclick="raceSelect.value=RACES[12]">
                </div>
            </div>
        </div>
        <div class="slide invisible" id="editPlayer">
            <div class="upper">
                <div class="content">
                    <div class="title">Dettagli giocatore</div>
                    <form action="javascript:checkAndSavePlayer()">
                        <div class="entry"><div class="entryName">Nome giocatore</div><input type="text" class="entryValue" id="playerName" value=""/></div>
                        <div class="entry"><div class="entryName">Nome personaggio</div><input type="text" class="entryValue" id="characterName" value=""/></div>
                        <div class="entry"><div class="entryName">Data di nascita</div><input type="date" class="entryValue" id="dob" value=""/></div>
                        <div class="entry"><div class="entryName">Specie</div><select class="entryValue" id="race"></select></div>
                        <script type="text/javascript">
                            var raceSelect=I("race");
                            raceSelect.innerHTML="";
                            var ids=Object.keys(RACES);
                            for(var i=0;i<ids.length;i++){
                                var o=document.createElement("option");
                                o.value=ids[i];
                                o.textContent=RACES[ids[i]].name;
                                raceSelect.appendChild(o);
                            }
                            raceSelect.value=raceSelect.childNodes[0].value;
                        </script>
                        <div class="entry"><div class="entryName">Squadra</div><select class="entryValue" id="team" value="solo"><option value="solo">Solo</option></select></div>
                        <div class="entry"><div class="entryName">Primo giocatore</div><select class="entryValue" id="firstPlayer" value="y"><option value="y">Si</option><option value="n">No</option></select></div>
                        <input type="submit" style="display:none" />
                        <div class="entry"><div class="entryName">Sesso biologico</div><select class="entryValue" id="sex"></select></div>
                        <div class="entry"><div class="entryName">Sesso espressivo</div><input type="text" class="entryValue" id="exsex" value=""/></div>
                            <div class="entry"><div class="entryName">Spiegazione sesso espressivo</div><input type="text" class="entryValue" id="explanationExSex" value=""/></div>
                    </form>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Annulla" onclick="cancelPlayerEdit()"/><input type="button" value="Conferma" onclick="checkAndSavePlayer()" />
            </div>
        </div>
        <div class="slide invisible" id="gameTimer">
            <div class="upper">
                <div class="content">
                    <div class="title">Turno <span id="roundNumber"></span> - <span id="gtDate"></span></div>
                    <div class="banner"><span id="playerAndCharacterName"></span><br/><span id="gtTeamName"></span></div>
                    <div class="mainTimerContainer">
                        <div class="timer" id="mainTimer">00:00</div>
                    </div>
                    <div class="smallTimers">
                        <div class="smallTimerContainer">
                            <div class="timer" id="playerTDuration">00:00</div>
                            <div class="timerName">Giocatore</div>
                        </div>
                        <div class="smallTimerContainer" id="teamTContainer">
                            <div class="timer" id="teamTDuration">00:00</div>
                            <div class="timerName">Squadra</div>
                        </div>
                        <div class="smallTimerContainer">
                            <div class="timer" id="roundTDuration">00:00</div>
                            <div class="timerName">Turno</div>
                        </div>
                    </div>
                    <div class="centered" id="soloButton" style="margin-top:2em">
                        <input type="button" id="nextPlayer" value="Prossimo giocatore" onclick="nextPlayer()"/><input type="button" value="Passa turno" onclick="nextPlayerWithTime()" />
                        <input type="button" value="Pausa" id="pauseBtn" onclick="pauseTimer()"/>
                    </div>
                    <div class="centered" id="teamButton" style="margin-top:2em">
                        <input type="button" value="Passa turno" onclick="nextPlayerWithTime()" />
                        <input type="button" value="Pausa" id="pauseBtn" onclick="pauseTimer()"/>
                    </div>
                    <div class="centered">
                        <input type="button" value="Tempo fantasma" onclick="beginGhostTime()"/><input type="button" value="Combattimento" onclick="beginCombat()"/>
                    </div>
                    <div class="banner" id="senilityCheckRequired" class="centered" style="margin-top:2em">
                        Deve eseguire test di senilità<br/>
                        <input type="button" value="Passato" onclick="senilityCheckPassed()"/><input type="button" value="Fallito" onclick="senilityCheckFailed()"/>
                    </div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Termina turno" onclick="stopRound()"/>
            </div>
        </div>
        <div class="slide invisible" id="ghostTime">
            <div class="upper">
                <div class="content">
                    <div class="title">Tempo fantasma</div>
                    <div class="mainTimerContainer">
                        <div class="timer" id="ghostTimeTimer">00:00</div>
                    </div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Fine tempo fantasma" onclick="endGhostTime()"/>
            </div>
        </div>
        <div class="slide invisible" id="combat">
            <div class="upper">
                <div class="content">
                    <div class="title">Combattimento <span id="combatTypeTitle"></span></div>
                    <div class="mainTimerContainer" id="combatTimeContainer">
                        <div class="timer" id="combatTimeTimer">00:00</div>
                    </div>
                    <div id="combatTypeButtonsContainer" class="centered">
                        <input type="button" value="Tattico" onclick="setCombatType(COMBATTYPE_TACTICAL)"/><input type="button" value="Narrato" onclick="setCombatType(COMBATTYPE_NARRATIVE)"/><input type="button" value="Entrambi" onclick="setCombatType(COMBATTYPE_BOTH)"/>
                    </div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Fine combattimento" onclick="endCombat()"/>
            </div>
        </div>
        <div class="slide invisible" id="endRound">
            <div class="upper">
                <div class="content">
                    <div class="title">Fine turno <span id="endRoundNumber"></span></div>
                    <div class="centered">
                        <input type="button" value="Scorri tempo" onclick="endRoundToDateChange()"/>
                    </div>
                    <div class="centered">
                        <input type="button" value="Gestione squadre e giocatori" onclick="endRoundToPlayerManagement()"/>
                    </div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Termina partita" onclick="stopGame(true)"/><input type="button" value="Prossimo turno" onclick="nextRound()"/>
            </div>
        </div>
        <div class="slide invisible" id="dateChange">
            <div class="upper">
                <div class="content">
                    <div class="title">Scorri tempo</div>
                    <form action="javascript:checkAndChangeDate()">
                        <div class="entry"><div class="entryName">Nuova data</div><input type="date" min="0000-01-01" max="9999-01-01" class="entryValue" id="newDate" value=""/></div>
                        <input type="submit" style="display:none" />
                    </form>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Annulla" onclick="cancelChangeDate()"/><input type="button" value="Conferma" onclick="checkAndChangeDate()" />
            </div>
        </div>
        <div class="slide invisible" id="dateChange2">
            <div class="upper">
                <div class="content">
                    <div class="title">Scorri tempo</div>
                    Questi personaggi hanno avuto uno scatto di età:
                    <ul id="ageChanges"></ul>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Continua" onclick="dateChangeToEndRound()" />
            </div>
        </div>
        <div class="slide invisible" id="endGame">
            <div class="upper">
                <div class="content">
                    <div class="title">Fine partita</div>
                    <div id="report"></div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Continua" onclick="endGameToWelcome()" />
            </div>
        </div>
        <div class="slide invisible" id="previousGames">
            <div class="upper">
                <div class="content">
                    <div class="title">Partite precedenti</div>
                    <div class="list" id="previousGamesList"></div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Indietro" onclick="previousGamesToWelcome()" />
            </div>
        </div>
        <div class="slide invisible" id="gameReport">
            <div class="upper">
                <div class="content">
                    <div class="title" id="reportName"></div>
                    <div id="reportBody"></div>
                </div>
            </div>
            <div class="lower">
                <input type="button" value="Chiudi" onclick="gameReportToPreviousGames()" /><input type="button" id="deleteReport" value="Cancella" onclick="" />
            </div>
        </div>
        <div id="modalContainer"></div>
        <script type="text/javascript">
            setTimeout(function(){
                document.body.removeChild(I("loadOverlay"));
                init();
            },500);
        </script>
        <script type="text/javascript">
            var ua=navigator.userAgent;
            if(/Firefox.(\d+)/i.test(ua)&&/Android|iPhone|iPad|iPod|Windows Phone|Mobile|Tablet/i.test(ua)){ //mobile firefox date picker sucks
                var dates=document.querySelectorAll('input[type="date"]');
                for(var i=0;i<dates.length;i++){
                    dates[i].type="text";
                    dates[i].placeholder="YYYY-MM-DD";
                }
            }
        </script>
    </body>
</html>